<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Peniel Estéreo</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.0/lottie.min.js"></script>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js";
    import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-messaging.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC2KTmkA-1znWUJxAociE0SygIsI-ZeeXg",
      authDomain: "notificacionespeniel.firebaseapp.com",
      projectId: "notificacionespeniel",
      storageBucket: "notificacionespeniel.firebasestorage.app",
      messagingSenderId: "634476182377",
      appId: "1:634476182377:web:ef93780f0cfbf866451bf8",
      measurementId: "G-L8Q4FJNGM7"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const messaging = getMessaging(app);

    document.getElementById("activarNotificaciones").addEventListener("click", () => {
      Notification.requestPermission().then(permission => {
        if (permission === "granted") {
          console.log("Permiso para notificaciones concedido");
          getToken(messaging, { vapidKey: "BCaaEb74fKiOfinyzKM6rHJf5FkuyPftwLEqEgOJS6j-BoW_Aj57Ao8uuMo4ofWgtpxt_WZl9lSUSIFKUDmBYmE" })
            .then((currentToken) => {
              if (currentToken) {
                console.log("Token de suscripción:", currentToken);
                fetch("https://tu-servidor.com/api/register-token", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ token: currentToken })
                });
              } else {
                console.log("No se pudo obtener el token");
              }
            })
            .catch((err) => console.log("Error al obtener el token:", err));
        }
      });
    });

    onMessage(messaging, (payload) => {
      console.log("Mensaje recibido en primer plano:", payload);
    });
  </script>
</head>
<body>
  <button id="activarNotificaciones" style="position: fixed; bottom: 60px; left: 50%; transform: translateX(-50%); background-color: #4CAF50; color: white; padding: 10px; border: none; border-radius: 5px; z-index: 1000;">
    Activar Notificaciones
  </button>
</body>
</html>
